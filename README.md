# Musceler
**Фоновый инструмент для macOS:** следит за появлением новых скриншотов в заданной папке и обрабатывает их (логика в watcher.py). Скрипт запускается автоматически при входе пользователя в систему через launchd (LaunchAgent).

## Что уже работает
* Скрипты запускаются и работают, выполняя свою задачу
* Watcher.py реализован и функционален
* Ведутся логи в musceler.log и musceler.err.log
* Настроен LaunchAgent для автозапуска

## Архитектура
```
musceler/
├─ scrn/            # локальная папка, куда macOS кладёт скриншоты
├─ scripts/         # все .py-скрипты
│  ├─ musceler.py
│  ├─ send_last_screenshot.py
│  └─ watcher.py
├─ logs/            # все логи
│  ├─ musceler.log
│  ├─ musceler.err.log
├─ assets/          # ресурсы (звуки, шаблоны и т.д.)
│  └─ notify.aiff   # (когда добавим звук)
└─ ...              # потом сюда же добавим .git, README.md и прочее
```

## Scripts
#### watcher.plist
Aккуратно всё поднимает и пишет логи.
~/Library/LaunchAgents/watcher.plist
#### watcher.py:
Cледит за новыми скриншотами.
* работает как демон/долгоживущий процесс
* отслеживает новые скриншоты в целевой директории (например, scrn/)
* пишет информацию о своей работе в логи (stdout и stderr).
#### send_last_screenshot.py:
Забирает последний скриншот, шлёт его через musceler.py и кладёт ссылку в буфер.
* находит самый свежий PNG‑файл в папке scrn/ внутри проекта
* запускает musceler.py как отдельный процесс, передавая ему путь к этому файлу
* парсит вывод musceler.py, вытаскивая строку с готовым URL ( Готово. URL: ...)
* копирует полученный URL в буфер обмена через pbcopy (macOS)
* печатает в консоль:
  * какой скриншот был выбран
    какой URL получился
  * сообщение о том, что ссылка скопирована в буфер обмена.
#### musceler.py:
Нумерует и заливает файл на сервер, возвращая готовый URL
* по SSH получает список файлов в удалённой директории /var/www/hhrrr.ru/musceler
* находит максимальный номер в именах формата scrn-00001.png, scrn-12345.jpg и т.п.
* вычисляет следующее имя scrn-XXXXX.png
* копирует локальный файл на сервер через scp под этим именем
* выводит готовый публичный URL вида http://hhrrr.ru/musceler/scrn-XXXXX.png.
### Логи
musceler.log — стандартный вывод (stdout) watcher.py
musceler.err.log — стандартный поток ошибок (stderr) watcher.py.

## Asstets
### Звуки
– Успешное завершение операции
[notify.mp3](README/notify.mp3)<!-- {"embed":"true"} -->
– Ошибка сервера
…


#project